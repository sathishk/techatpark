<!DOCTYPE html>
<html lang="en">

<head>


  <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <base href="/">
    <title>TECHATPARK - BUILDING PRO-GRAMMERS !</title>

    
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/logo_full.svg"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/logo_full.svg"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/logo_full.svg"
    />
    <link rel="manifest" href="/images/site.webmanifest" />

    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />


    

    <link rel="stylesheet" href="/css/style.css"/>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"
      integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ="
      crossorigin="anonymous"
    />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

    

       

  


</head>

<body>
  
  
  

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <img src="/images/logo.svg" alt="" width="30" height="30" class="d-inline-block align-text-top">
      TECH@PARK
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse d-flex justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
        
        <li class="nav-item">
          <a class="nav-link active" href="/our-method">Our Method</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/our-values">Our Values</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/our-achievements">Our Achievement</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/posts">Blog</a>
        </li>
        
        
      </ul>
    </div>
  </div>
</nav>
  
 

  <main class="container-fluid w-100 h-100">
    <div class="row w-100 h-100" id="main-container">
      

<article>
  <header>
    <h1>Building SQL Builder with Native Java: Simplifying JDBC Code</h1>
    <p>by 
  
  <a href="/authors/sathishk">sathishk</a>

   & 
  <a href="/authors/hari-nikesh-r">hari-nikesh-r</a>

</p>
    
  </header>

  <p>In our previous blog on <a href="/posts/api-design/">API design</a>, we explored the art of creating APIs that are simple, elegant, and optimized. Now, let’s apply those principles to building SQL Builders using plain JDBC in native Java, providing a streamlined approach to working with databases while keeping the code concise and efficient.</p>
<p><strong>SQL Builders</strong> simplify database interactions by abstracting away raw SQL queries and connection management, allowing developers to focus on business logic. Popular tools like Spring JDBC and QueryDSL help construct SQL queries programmatically, making code cleaner and easier to maintain.</p>
<h3 id="motivation">Motivation</h3>
<p>Many developers rely on third-party frameworks like Spring JDBC Template and MyBatis for SQL Builders. Building this functionality natively in Java can offer a lighter, more customizable solution. Let’s design an API for common database operations with plain JDBC.</p>
<h3 id="setup">Setup</h3>
<p>We’ll use an H2 database with the following table:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> movie (
</span></span><span style="display:flex;"><span>    id bigint auto_increment <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span>,
</span></span><span style="display:flex;"><span>    title VARCHAR(<span style="color:#ae81ff">80</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
</span></span><span style="display:flex;"><span>    directed_by VARCHAR(<span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>We configure the <code>JdbcDataSource</code> as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>JdbcDataSource dataSource <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JdbcDataSource<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">setURL</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jdbc:h2:~/test&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">setUser</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sa&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sa&#34;</span><span style="color:#f92672">);</span>
</span></span></code></pre></div><p>We define the <code>Movie</code> record:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> record <span style="color:#a6e22e">Movie</span><span style="color:#f92672">(</span>Long id<span style="color:#f92672">,</span> String title<span style="color:#f92672">,</span> String directedBy<span style="color:#f92672">)</span> <span style="color:#f92672">{}</span>
</span></span></code></pre></div><h3 id="inserting-records">Inserting Records</h3>
<p>We insert two movie records:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> movie(title, directed_by) 
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">VALUES</span> (<span style="color:#e6db74">&#39;Dunkirk&#39;</span>, <span style="color:#e6db74">&#39;Nolan&#39;</span>),
</span></span><span style="display:flex;"><span>             (<span style="color:#e6db74">&#39;Inception&#39;</span>, <span style="color:#e6db74">&#39;Nolan&#39;</span>);
</span></span></code></pre></div><h4 id="jdbc-code-for-inserting-records">JDBC Code for Inserting Records</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;INSERT INTO movie(title, directed_by) VALUES (?, ?), (?, ?)&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>Connection conn <span style="color:#f92672">=</span> dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>     PreparedStatement ps <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Dunkirk&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span><span style="color:#ae81ff">2</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Nolan&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span><span style="color:#ae81ff">3</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Inception&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">setString</span><span style="color:#f92672">(</span><span style="color:#ae81ff">4</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Nolan&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">executeUpdate</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="querying-records">Querying Records</h3>
<h4 id="single-record-query">Single Record Query</h4>
<p>Query for a single movie by ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> id, title, directed_by <span style="color:#66d9ef">FROM</span> movie <span style="color:#66d9ef">WHERE</span> id <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span></code></pre></div><h5 id="jdbc-code-for-single-record-query">JDBC Code for Single Record Query</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id, title, directed_by FROM movie WHERE id = ?&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>Movie movie <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>Connection conn <span style="color:#f92672">=</span> dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>     PreparedStatement ps <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ps<span style="color:#f92672">.</span><span style="color:#a6e22e">setLong</span><span style="color:#f92672">(</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>ResultSet rs <span style="color:#f92672">=</span> ps<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            movie <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Movie<span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getLong</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">),</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;title&#34;</span><span style="color:#f92672">),</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;directed_by&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="multiple-record-query">Multiple Record Query</h4>
<p>Query all movies:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> id, title, directed_by <span style="color:#66d9ef">FROM</span> movie;
</span></span></code></pre></div><h5 id="jdbc-code-for-multiple-record-query">JDBC Code for Multiple Record Query</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id, title, directed_by FROM movie&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Movie<span style="color:#f92672">&gt;</span> movies <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span> <span style="color:#f92672">(</span>Connection conn <span style="color:#f92672">=</span> dataSource<span style="color:#f92672">.</span><span style="color:#a6e22e">getConnection</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>     PreparedStatement ps <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span><span style="color:#a6e22e">prepareStatement</span><span style="color:#f92672">(</span>sql<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>     ResultSet rs <span style="color:#f92672">=</span> ps<span style="color:#f92672">.</span><span style="color:#a6e22e">executeQuery</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        movies<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Movie<span style="color:#f92672">(</span>rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getLong</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">),</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;title&#34;</span><span style="color:#f92672">),</span> rs<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;directed_by&#34;</span><span style="color:#f92672">)));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div>
</article>


    </div>
    
  </main>

  
  <div class="fixed-bottom bg-transparent">
  <small>Made with <i class="fas fa-heart"></i>
    for the learning by students of <a class="text-decoration-none" href="http://www.techatpark.com" target="_techatpark">Tech@Park</a>
  </small>
</div>

  

  


<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>





  
    

  
</body>

</html>